<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CyberLab - Penetration Testing & Cryptography Environment</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: #0a0a0a;
            color: #00ff00;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .matrix-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0.1;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            background: rgba(0, 255, 0, 0.1);
            padding: 30px;
            border: 2px solid #00ff00;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.3);
            animation: glow 2s infinite alternate;
        }

        @keyframes glow {
            from { box-shadow: 0 0 20px rgba(0, 255, 0, 0.3); }
            to { box-shadow: 0 0 30px rgba(0, 255, 0, 0.6); }
        }

        .header h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            text-shadow: 0 0 10px #00ff00;
            animation: typing 4s steps(20) infinite;
        }

        @keyframes typing {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.7; }
        }

        .nav-tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            gap: 10px;
            flex-wrap: wrap;
        }

        .nav-tab {
            padding: 12px 25px;
            background: rgba(0, 255, 0, 0.1);
            border: 1px solid #00ff00;
            color: #00ff00;
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 5px;
            font-family: inherit;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .nav-tab:hover, .nav-tab.active {
            background: rgba(0, 255, 0, 0.3);
            box-shadow: 0 0 15px rgba(0, 255, 0, 0.5);
            transform: translateY(-2px);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .vulnerable-site {
            background: rgba(20, 20, 20, 0.9);
            border: 1px solid #333;
            border-radius: 10px;
            margin-bottom: 30px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
        }

        .site-header {
            background: #1a1a1a;
            padding: 15px 20px;
            border-bottom: 1px solid #333;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .site-title {
            color: #ff6b6b;
            font-size: 1.2rem;
            font-weight: bold;
        }

        .vulnerability-badge {
            background: #dc3545;
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .site-content {
            padding: 20px;
        }

        .login-form, .admin-panel, .user-profile {
            background: rgba(40, 40, 40, 0.8);
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #555;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #ccc;
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 10px;
            background: #222;
            border: 1px solid #555;
            color: #00ff00;
            border-radius: 5px;
            font-family: inherit;
            resize: vertical;
        }

        .form-group textarea {
            min-height: 120px;
            font-size: 0.9rem;
        }

        .form-group input[type="range"] {
            -webkit-appearance: none;
            appearance: none;
            height: 5px;
            background: #333;
            outline: none;
            border-radius: 5px;
        }

        .form-group input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: #00ff00;
            border-radius: 50%;
            cursor: pointer;
        }

        .btn {
            padding: 10px 20px;
            background: #00ff00;
            color: #000;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-family: inherit;
            font-weight: bold;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .btn:hover {
            background: #00cc00;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 255, 0, 0.3);
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn-danger:hover {
            background: #c82333;
        }

        .btn-secondary {
            background: #007acc;
            color: white;
        }

        .btn-secondary:hover {
            background: #0056b3;
        }

        .tools-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 30px;
            margin-bottom: 30px;
        }

        .tool-panel {
            background: rgba(20, 20, 20, 0.95);
            border: 2px solid #00ff00;
            border-radius: 10px;
            padding: 20px;
        }

        .tool-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #333;
        }

        .tool-icon {
            font-size: 1.5rem;
            margin-right: 10px;
        }

        .tool-title {
            color: #00ff00;
            font-size: 1.3rem;
            font-weight: bold;
        }

        .terminal {
            background: #000;
            border: 1px solid #333;
            border-radius: 5px;
            padding: 15px;
            height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            margin: 10px 0;
        }

        .terminal-line {
            margin-bottom: 5px;
            word-break: break-all;
        }

        .terminal-prompt {
            color: #00ff00;
        }

        .terminal-output {
            color: #fff;
        }

        .terminal-error {
            color: #ff6b6b;
        }

        .terminal-success {
            color: #28a745;
        }

        .explanation-panel {
            background: rgba(0, 50, 100, 0.2);
            border: 1px solid #007acc;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }

        .explanation-header {
            color: #4dabf7;
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }

        .explanation-content {
            color: #b8e6ff;
            line-height: 1.6;
        }

        .code-block {
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 5px;
            padding: 15px;
            margin: 10px 0;
            overflow-x: auto;
        }

        .code-block pre {
            color: #fff;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
        }

        .results-panel {
            background: rgba(40, 40, 40, 0.9);
            border: 1px solid #666;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }

        .result-item {
            padding: 10px;
            margin: 5px 0;
            border-radius: 5px;
            border-left: 4px solid;
        }

        .result-success {
            background: rgba(40, 167, 69, 0.2);
            border-left-color: #28a745;
        }

        .result-warning {
            background: rgba(255, 193, 7, 0.2);
            border-left-color: #ffc107;
        }

        .result-danger {
            background: rgba(220, 53, 69, 0.2);
            border-left-color: #dc3545;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #333;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #00ff00, #007acc);
            border-radius: 10px;
            transition: width 0.5s ease;
            position: relative;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent 49%, rgba(255,255,255,0.1) 50%, transparent 51%);
            animation: progress-shine 2s infinite;
        }

        @keyframes progress-shine {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .user-list {
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid #333;
            border-radius: 5px;
            background: #1a1a1a;
        }

        .user-item {
            padding: 10px;
            border-bottom: 1px solid #333;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .user-item:hover {
            background: rgba(0, 255, 0, 0.1);
        }

        .user-item:last-child {
            border-bottom: none;
        }

        .output-box {
            background: #000;
            border: 2px solid #00ff00;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            color: #00ff00;
            word-break: break-all;
            position: relative;
            min-height: 120px;
            box-shadow: 0 0 10px rgba(0, 255, 0, 0.2);
            white-space: pre-wrap;
        }

        .output-box.empty {
            color: #666;
            font-style: italic;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .copy-btn {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(0, 255, 0, 0.2);
            border: 1px solid #00ff00;
            color: #00ff00;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 0.8rem;
        }

        .copy-btn:hover {
            background: rgba(0, 255, 0, 0.4);
        }

        .shift-display {
            background: rgba(0, 255, 0, 0.1);
            border: 1px solid #00ff00;
            border-radius: 5px;
            padding: 10px;
            text-align: center;
            font-size: 1.2rem;
            font-weight: bold;
            margin: 10px 0;
        }

        .alphabet-table {
            background: rgba(20, 20, 20, 0.8);
            border: 1px solid #333;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
        }

        .alphabet-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-family: 'Courier New', monospace;
        }

        .alphabet-label {
            color: #4dabf7;
            font-weight: bold;
            width: 100px;
        }

        .alphabet-chars {
            color: #00ff00;
            flex: 1;
            letter-spacing: 2px;
        }

        .frequency-analysis {
            background: rgba(40, 40, 40, 0.8);
            border: 1px solid #555;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
        }

        .freq-chart {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(30px, 1fr));
            gap: 2px;
            margin-top: 10px;
        }

        .freq-bar {
            background: #333;
            border-radius: 2px;
            position: relative;
            height: 60px;
            display: flex;
            align-items: end;
        }

        .freq-fill {
            width: 100%;
            background: linear-gradient(to top, #00ff00, #007acc);
            border-radius: 2px;
            transition: height 0.5s ease;
        }

        .freq-label {
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.7rem;
            color: #ccc;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: rgba(0, 255, 0, 0.1);
            border: 1px solid #00ff00;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: #00ff00;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #ccc;
            margin-top: 5px;
        }

        @media (max-width: 768px) {
            .tools-section {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .nav-tabs {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <canvas class="matrix-bg" id="matrix"></canvas>
    
    <div class="container">
        <div class="header">
            <h1>🔴 CYBERLAB 🔴</h1>
            <p>Penetration Testing & Cryptography Environment</p>
            <p style="font-size: 0.9rem; opacity: 0.7; margin-top: 10px;">
                ⚠️ For Educational Purposes Only ⚠️
            </p>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('vulnerable-sites')">🎯 Vulnerable Sites</button>
            <button class="nav-tab" onclick="showTab('idor-tool')">🔍 IDOR Scanner</button>
            <button class="nav-tab" onclick="showTab('password-tool')">🔐 Password Cracker</button>
            <button class="nav-tab" onclick="showTab('encrypt')">🔐 Caesar Encrypt</button>
            <button class="nav-tab" onclick="showTab('decrypt')">🔓 Caesar Decrypt</button>
            <button class="nav-tab" onclick="showTab('analyzer')">📊 Frequency Analysis</button>
            <button class="nav-tab" onclick="showTab('brute-force')">⚡ Caesar Brute Force</button>
            <button class="nav-tab" onclick="showTab('explanations')">📚 Explanations</button>
            <button class="nav-tab" onclick="showTab('results')">📊 Results</button>
        </div>

        <!-- Vulnerable Sites Tab -->
        <div id="vulnerable-sites" class="tab-content active">
            <div class="vulnerable-site">
                <div class="site-header">
                    <div class="site-title">🏦 SecureBank Login</div>
                    <div class="vulnerability-badge">IDOR Vulnerable</div>
                </div>
                <div class="site-content">
                    <div class="login-form">
                        <h3>Customer Login Portal</h3>
                        <form id="bank-login">
                            <div class="form-group">
                                <label>Username:</label>
                                <input type="text" id="bank-username" placeholder="Enter username">
                            </div>
                            <div class="form-group">
                                <label>Password:</label>
                                <input type="password" id="bank-password" placeholder="Enter password">
                            </div>
                            <button type="submit" class="btn">Login</button>
                        </form>
                        
                        <div style="margin-top: 20px; padding: 15px; background: rgba(0,100,0,0.1); border-radius: 5px;">
                            <strong>💡 Test Credentials:</strong><br>
                            Username: <code>user1</code> | Password: <code>pass123</code><br>
                            Username: <code>admin</code> | Password: <code>admin123</code>
                        </div>
                    </div>
                </div>
            </div>

            <div class="vulnerable-site">
                <div class="site-header">
                    <div class="site-title">👤 User Profile System</div>
                    <div class="vulnerability-badge">IDOR Vulnerable</div>
                </div>
                <div class="site-content">
                    <div class="user-profile" id="profile-section" style="display: none;">
                        <h3>User Profile</h3>
                        <div id="profile-content">
                            <!-- Dynamic profile content -->
                        </div>
                        
                        <div style="margin-top: 20px;">
                            <strong>🔗 Direct Access URLs:</strong><br>
                            <div style="margin: 10px 0;">
                                <input type="text" id="profile-url" placeholder="Enter User ID (1-10)" style="width: 200px; margin-right: 10px;">
                                <button class="btn" onclick="loadProfile()">Load Profile</button>
                            </div>
                            <small style="color: #666;">Try IDs: 1, 2, 3, 4, 5...</small>
                        </div>
                    </div>
                    
                    <div id="profile-login">
                        <p>Please login to view profiles</p>
                        <button class="btn" onclick="showProfile()">Access Profile System</button>
                    </div>
                </div>
            </div>

            <div class="vulnerable-site">
                <div class="site-header">
                    <div class="site-title">🏢 Admin Panel</div>
                    <div class="vulnerability-badge">Weak Passwords</div>
                </div>
                <div class="site-content">
                    <div class="admin-panel">
                        <h3>Administrator Access</h3>
                        <form id="admin-login">
                            <div class="form-group">
                                <label>Admin Username:</label>
                                <input type="text" id="admin-username" placeholder="Enter admin username">
                            </div>
                            <div class="form-group">
                                <label>Admin Password:</label>
                                <input type="password" id="admin-password" placeholder="Enter admin password">
                            </div>
                            <button type="submit" class="btn">Admin Login</button>
                        </form>
                        
                        <div style="margin-top: 20px; padding: 15px; background: rgba(100,0,0,0.1); border-radius: 5px;">
                            <strong>🎯 Brute Force Target:</strong><br>
                            Try common passwords: <code>admin</code>, <code>123456</code>, <code>password</code>, <code>root</code>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- IDOR Scanner Tool -->
        <div id="idor-tool" class="tab-content">
            <div class="tools-section">
                <div class="tool-panel">
                    <div class="tool-header">
                        <div class="tool-icon">🔍</div>
                        <div class="tool-title">IDOR Scanner</div>
                    </div>
                    
                    <div class="form-group">
                        <label>Target URL Pattern:</label>
                        <input type="text" id="idor-url" placeholder="http://example.com/profile?id=USER_ID" value="profile?id=USER_ID">
                    </div>
                    
                    <div class="form-group">
                        <label>ID Range:</label>
                        <div style="display: flex; gap: 10px;">
                            <input type="number" id="idor-start" placeholder="Start" value="1" style="width: 100px;">
                            <input type="number" id="idor-end" placeholder="End" value="20" style="width: 100px;">
                        </div>
                    </div>
                    
                    <button class="btn" onclick="startIdorScan()">🚀 Start IDOR Scan</button>
                    <button class="btn btn-danger" onclick="stopIdorScan()">⏹️ Stop Scan</button>
                    
                    <div class="progress-bar">
                        <div class="progress-fill" id="idor-progress" style="width: 0%;"></div>
                    </div>
                    
                    <div class="terminal" id="idor-terminal">
                        <div class="terminal-line terminal-prompt">root@cyberlab:~# IDOR Scanner v2.1</div>
                        <div class="terminal-line terminal-output">Ready to scan for Insecure Direct Object References...</div>
                        <div class="terminal-line terminal-prompt">────────────────────────────────────────</div>
                    </div>
                </div>

                <div class="tool-panel">
                    <div class="tool-header">
                        <div class="tool-icon">📊</div>
                        <div class="tool-title">IDOR Results</div>
                    </div>
                    
                    <div class="results-panel" id="idor-results">
                        <p style="color: #666;">No scan results yet. Start an IDOR scan to see results here.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Password Cracker Tool -->
        <div id="password-tool" class="tab-content">
            <div class="tools-section">
                <div class="tool-panel">
                    <div class="tool-header">
                        <div class="tool-icon">🔐</div>
                        <div class="tool-title">Password Cracker</div>
                    </div>
                    
                    <div class="form-group">
                        <label>Target:</label>
                        <select id="crack-target">
                            <option value="admin">Admin Panel (admin user)</option>
                            <option value="bank">SecureBank (user1)</option>
                            <option value="custom">Custom Target</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Attack Method:</label>
                        <select id="crack-method">
                            <option value="dictionary">Dictionary Attack</option>
                            <option value="brute-force">Brute Force</option>
                            <option value="common">Common Passwords</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Custom Username (if Custom Target):</label>
                        <input type="text" id="custom-username" placeholder="Enter username">
                    </div>
                    
                    <button class="btn" onclick="startPasswordCrack()">⚡ Start Cracking</button>
                    <button class="btn btn-danger" onclick="stopPasswordCrack()">⏹️ Stop Attack</button>
                    
                    <div class="progress-bar">
                        <div class="progress-fill" id="crack-progress" style="width: 0%;"></div>
                    </div>
                    
                    <div class="terminal" id="crack-terminal">
                        <div class="terminal-line terminal-prompt">root@cyberlab:~# PasswordCracker v3.0</div>
                        <div class="terminal-line terminal-output">Advanced password cracking toolkit ready...</div>
                        <div class="terminal-line terminal-prompt">────────────────────────────────────────</div>
                    </div>
                </div>

                <div class="tool-panel">
                    <div class="tool-header">
                        <div class="tool-icon">🎯</div>
                        <div class="tool-title">Crack Results</div>
                    </div>
                    
                    <div class="results-panel" id="crack-results">
                        <p style="color: #666;">No cracking attempts yet. Start a password attack to see results here.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Encryption Tab -->
        <div id="encrypt" class="tab-content">
            <div class="tools-section">
                <div class="tool-panel">
                    <div class="tool-header">
                        <div class="tool-icon">🔐</div>
                        <div class="tool-title">Caesar Encryption</div>
                    </div>
                    
                    <div class="form-group">
                        <label>Text to Encrypt:</label>
                        <textarea id="encrypt-input" placeholder="Enter text here..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Shift Amount: <span id="encrypt-shift-value">3</span></label>
                        <input type="range" id="encrypt-shift" min="1" max="25" value="3" oninput="updateEncryptShift()">
                    </div>

                    <div class="shift-display" id="encrypt-shift-display">
                        Shift: 3 (A → D, B → E, C → F...)
                    </div>
                    
                    <button class="btn" onclick="encryptText()">🔐 Encrypt Text</button>
                    <button class="btn btn-secondary" onclick="clearEncrypt()">🗑️ Clear</button>
                </div>

                <div class="tool-panel">
                    <div class="tool-header">
                        <div class="tool-icon">📝</div>
                        <div class="tool-title">Encrypted Text</div>
                    </div>
                    
                    <div class="output-box empty" id="encrypt-output">
                        Enter text and click "Encrypt Text" to see the result here
                        <button class="copy-btn" onclick="copyEncrypted()" style="display: none;">📋 Copy</button>
                    </div>

                    <div class="alphabet-table">
                        <div class="alphabet-row">
                            <div class="alphabet-label">Original:</div>
                            <div class="alphabet-chars" id="original-alphabet">ABCDEFGHIJKLMNOPQRSTUVWXYZ</div>
                        </div>
                        <div class="alphabet-row">
                            <div class="alphabet-label">Encrypted:</div>
                            <div class="alphabet-chars" id="shifted-alphabet">DEFGHIJKLMNOPQRSTUVWXYZABC</div>
                        </div>
                    </div>

                    <div class="terminal" id="encrypt-terminal">
                        <div class="terminal-line terminal-prompt">root@cyberlab:~# Caesar Encryption Engine v2.0</div>
                        <div class="terminal-line terminal-output">Ready to encrypt texts using Caesar cipher...</div>
                        <div class="terminal-line terminal-prompt">────────────────────────────────────────</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Decryption Tab -->
        <div id="decrypt" class="tab-content">
            <div class="tools-section">
                <div class="tool-panel">
                    <div class="tool-header">
                        <div class="tool-icon">🔓</div>
                        <div class="tool-title">Caesar Decryption</div>
                    </div>
                    
                    <div class="form-group">
                        <label>Encrypted Text:</label>
                        <textarea id="decrypt-input" placeholder="Enter encrypted text here..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Shift Amount: <span id="decrypt-shift-value">3</span></label>
                        <input type="range" id="decrypt-shift" min="1" max="25" value="3" oninput="updateDecryptShift()">
                    </div>

                    <div class="shift-display" id="decrypt-shift-display">
                        Shift: 3 (D → A, E → B, F → C...)
                    </div>
                    
                    <button class="btn" onclick="decryptText()">🔓 Decrypt Text</button>
                    <button class="btn btn-secondary" onclick="clearDecrypt()">🗑️ Clear</button>
                </div>

                <div class="tool-panel">
                    <div class="tool-header">
                        <div class="tool-icon">📄</div>
                        <div class="tool-title">Decrypted Text</div>
                    </div>
                    
                    <div class="output-box empty" id="decrypt-output">
                        Enter encrypted text and click "Decrypt Text" to see the result here
                        <button class="copy-btn" onclick="copyDecrypted()" style="display: none;">📋 Copy</button>
                    </div>

                    <div class="terminal" id="decrypt-terminal">
                        <div class="terminal-line terminal-prompt">root@cyberlab:~# Caesar Decryption Engine v2.0</div>
                        <div class="terminal-line terminal-output">Ready to decrypt Caesar encrypted texts...</div>
                        <div class="terminal-line terminal-prompt">────────────────────────────────────────</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Frequency Analysis Tab -->
        <div id="analyzer" class="tab-content">
            <div class="tools-section">
                <div class="tool-panel">
                    <div class="tool-header">
                        <div class="tool-icon">📊</div>
                        <div class="tool-title">Frequency Analysis</div>
                    </div>
                    
                    <div class="form-group">
                        <label>Text to Analyze:</label>
                        <textarea id="analyze-input" placeholder="Enter text here for frequency analysis..."></textarea>
                    </div>
                    
                    <button class="btn" onclick="analyzeFrequency()">📊 Analyze Frequency</button>
                    <button class="btn btn-secondary" onclick="clearAnalyzer()">🗑️ Clear</button>

                    <div class="stats-grid" id="analysis-stats">
                        <div class="stat-card">
                            <div class="stat-number" id="total-chars">0</div>
                            <div class="stat-label">Total Characters</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="unique-chars">0</div>
                            <div class="stat-label">Unique Characters</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="most-common">-</div>
                            <div class="stat-label">Most Frequent</div>
                        </div>
                    </div>
                </div>

                <div class="tool-panel">
                    <div class="tool-header">
                        <div class="tool-icon">📈</div>
                        <div class="tool-title">Frequency Chart</div>
                    </div>
                    
                    <div class="frequency-analysis">
                        <h4 style="color: #4dabf7; margin-bottom: 15px;">Character Frequency:</h4>
                        <div class="freq-chart" id="frequency-chart">
                            <p style="color: #666; text-align: center;">Enter text to analyze</p>
                        </div>
                    </div>

                    <div class="terminal" id="analyzer-terminal">
                        <div class="terminal-line terminal-prompt">root@cyberlab:~# Frequency Analysis Tool v2.0</div>
                        <div class="terminal-line terminal-output">Ready to analyze character frequency in texts...</div>
                        <div class="terminal-line terminal-prompt">────────────────────────────────────────</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Brute Force Tab -->
        <div id="brute-force" class="tab-content">
            <div class="tools-section">
                <div class="tool-panel">
                    <div class="tool-header">
                        <div class="tool-icon">⚡</div>
                        <div class="tool-title">Caesar Brute Force</div>
                    </div>
                    
                    <div class="form-group">
                        <label>Encrypted Text to Crack:</label>
                        <textarea id="brute-input" placeholder="Enter encrypted text here..."></textarea>
                    </div>
                    
                    <button class="btn" onclick="startBruteForce()">⚡ Start Cracking</button>
                    <button class="btn btn-danger" onclick="stopBruteForce()">⏹️ Stop</button>
                    <button class="btn btn-secondary" onclick="clearBruteForce()">🗑️ Clear</button>

                    <div class="terminal" id="brute-terminal">
                        <div class="terminal-line terminal-prompt">root@cyberlab:~# Caesar Brute Force Cracker v2.0</div>
                        <div class="terminal-line terminal-output">Ready to crack Caesar cipher by trying all shifts...</div>
                        <div class="terminal-line terminal-prompt">────────────────────────────────────────</div>
                    </div>
                </div>

                <div class="tool-panel">
                    <div class="tool-header">
                        <div class="tool-icon">🎯</div>
                        <div class="tool-title">Crack Results</div>
                    </div>
                    
                    <div id="brute-results" style="max-height: 400px; overflow-y: auto;">
                        <p style="color: #666; text-align: center; padding: 20px;">
                            Enter encrypted text and click "Start Cracking" to see all possibilities
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Explanations Tab -->
        <div id="explanations" class="tab-content">
            <div class="explanation-panel">
                <div class="explanation-header">
                    🎯 What is IDOR (Insecure Direct Object References)?
                </div>
                <div class="explanation-content">
                    <p><strong>IDOR</strong> is a vulnerability that occurs when an application provides direct access to objects based on user-supplied input. An attacker can bypass authorization and access resources belonging to other users.</p>
                    
                    <h4 style="color: #4dabf7; margin: 15px 0 10px 0;">How IDOR Works:</h4>
                    <ol style="margin-left: 20px;">
                        <li>User logs into application and gets assigned user ID = 123</li>
                        <li>Application shows profile via URL: <code>/profile?id=123</code></li>
                        <li>Attacker changes URL to: <code>/profile?id=124</code></li>
                        <li>If vulnerable, attacker sees another user's profile</li>
                    </ol>

                    <h4 style="color: #4dabf7; margin: 15px 0 10px 0;">Example Vulnerable Code:</h4>
                    <div class="code-block">
                        <pre>// PHP Example - VULNERABLE
$user_id = $_GET['id'];  // Direct user input
$query = "SELECT * FROM users WHERE id = $user_id";
// No authorization check!</pre>
                    </div>

                    <h4 style="color: #4dabf7; margin: 15px 0 10px 0;">Secure Code Example:</h4>
                    <div class="code-block">
                        <pre>// PHP Example - SECURE
$user_id = $_GET['id'];
$current_user = getCurrentUser();

// Check if current user owns this resource
if ($user_id != $current_user['id'] && !$current_user['is_admin']) {
    die("Access Denied");
}

$query = "SELECT * FROM users WHERE id = $user_id";</pre>
                    </div>
                </div>
            </div>

            <div class="explanation-panel">
                <div class="explanation-header">
                    🔐 Password Cracking Techniques
                </div>
                <div class="explanation-content">
                    <p><strong>Password Cracking</strong> is the process of recovering passwords from data stored or transmitted by computer systems.</p>
                    
                    <h4 style="color: #4dabf7; margin: 15px 0 10px 0;">Common Attack Methods:</h4>
                    
                    <h5 style="color: #00ff00; margin: 10px 0 5px 0;">1. Dictionary Attack:</h5>
                    <p>Uses a pre-compiled list of common passwords</p>
                    <div class="code-block">
                        <pre>Common passwords: password, 123456, admin, qwerty, letmein</pre>
                    </div>

                    <h5 style="color: #00ff00; margin: 10px 0 5px 0;">2. Brute Force Attack:</h5>
                    <p>Systematically tries all possible combinations</p>
                    <div class="code-block">
                        <pre>a, b, c, ..., aa, ab, ac, ..., aaa, aab, aac...</pre>
                    </div>

                    <h5 style="color: #00ff00; margin: 10px 0 5px 0;">3. Hybrid Attack:</h5>
                    <p>Combines dictionary words with numbers/symbols</p>
                    <div class="code-block">
                        <pre>password123, admin2024, qwerty!</pre>
                    </div>

                    <h4 style="color: #4dabf7; margin: 15px 0 10px 0;">Defense Strategies:</h4>
                    <ul style="margin-left: 20px;">
                        <li>Use strong, complex passwords (12+ characters)</li>
                        <li>Implement account lockout after failed attempts</li>
                        <li>Use multi-factor authentication (MFA)</li>
                        <li>Implement CAPTCHA for login forms</li>
                        <li>Use password hashing with salt</li>
                    </ul>
                </div>
            </div>

            <div class="explanation-panel">
                <div class="explanation-header">
                    🔐 What is Caesar Cipher?
                </div>
                <div class="explanation-content">
                    <p><strong>Caesar Cipher</strong> is one of the oldest and simplest encryption techniques, named after Julius Caesar who used it to protect his military messages.</p>
                    
                    <h4 style="color: #4dabf7; margin: 15px 0 10px 0;">How it Works:</h4>
                    <ol style="margin-left: 20px;">
                        <li>Each letter in the text is shifted by a fixed number of positions in the alphabet</li>
                        <li>If the shift is 3, then A becomes D, B becomes E, and so on</li>
                        <li>When reaching the end of the alphabet, wrap around (Z becomes C with shift 3)</li>
                    </ol>

                    <h4 style="color: #4dabf7; margin: 15px 0 10px 0;">Example:</h4>
                    <div class="code-block">
                        <pre>Original Text: HELLO WORLD
Shift: 3
Encrypted: KHOOR ZRUOG

Explanation:
H + 3 = K
E + 3 = H  
L + 3 = O
...</pre>
                    </div>

                    <h4 style="color: #4dabf7; margin: 15px 0 10px 0;">Mathematical Formula:</h4>
                    <div class="code-block">
                        <pre>Encryption: C = (P + K) mod 26
Decryption: P = (C - K) mod 26

Where:
C = Encrypted character
P = Original character  
K = Shift key
26 = Number of letters in English alphabet</pre>
                    </div>
                </div>
            </div>

            <div class="explanation-panel">
                <div class="explanation-header">
                    🔓 Caesar Cipher Breaking Techniques
                </div>
                <div class="explanation-content">
                    <h4 style="color: #4dabf7; margin: 15px 0 10px 0;">1. Brute Force Attack:</h4>
                    <p>Try all possible shifts (1-25) until we find readable text</p>
                    <div class="code-block">
                        <pre>Encrypted Text: KHOOR
Shift 1: JGNNQ
Shift 2: IFMMP  
Shift 3: HELLO ← Correct result!</pre>
                    </div>

                    <h4 style="color: #4dabf7; margin: 15px 0 10px 0;">2. Frequency Analysis:</h4>
                    <p>Analyze character frequency and compare with natural language patterns</p>
                    <ul style="margin-left: 20px;">
                        <li>Letter E is most frequent in English</li>
                        <li>If X is most frequent in encrypted text, shift = X - E</li>
                        <li>Apply same principle to other letters for verification</li>
                    </ul>

                    <h4 style="color: #4dabf7; margin: 15px 0 10px 0;">3. Pattern Analysis:</h4>
                    <p>Look for common words like "THE" or "AND" in the encrypted text</p>
                </div>
            </div>

            <div class="explanation-panel">
                <div class="explanation-header">
                    🛡️ Penetration Testing Methodology
                </div>
                <div class="explanation-content">
                    <h4 style="color: #4dabf7; margin: 15px 0 10px 0;">Standard Pen Testing Process:</h4>
                    <ol style="margin-left: 20px;">
                        <li><strong>Reconnaissance:</strong> Gather information about target</li>
                        <li><strong>Scanning:</strong> Identify live systems and services</li>
                        <li><strong>Enumeration:</strong> Extract detailed information</li>
                        <li><strong>Vulnerability Assessment:</strong> Find security weaknesses</li>
                        <li><strong>Exploitation:</strong> Attempt to exploit vulnerabilities</li>
                        <li><strong>Reporting:</strong> Document findings and recommendations</li>
                    </ol>

                    <h4 style="color: #4dabf7; margin: 15px 0 10px 0;">Legal and Ethical Considerations:</h4>
                    <ul style="margin-left: 20px; color: #ff6b6b;">
                        <li>Always obtain written permission before testing</li>
                        <li>Only test systems you own or have explicit permission to test</li>
                        <li>Follow responsible disclosure practices</li>
                        <li>Respect privacy and confidentiality</li>
                        <li>Use findings to improve security, not cause harm</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Results Tab -->
        <div id="results" class="tab-content">
            <div class="results-panel">
                <h3 style="color: #00ff00; margin-bottom: 20px;">🏆 Security Testing Results Dashboard</h3>
                
                <div id="results-summary">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px;">
                        <div style="background: rgba(40, 167, 69, 0.2); padding: 15px; border-radius: 8px; text-align: center;">
                            <div style="font-size: 2rem; color: #28a745;">0</div>
                            <div>Vulnerabilities Found</div>
                        </div>
                        <div style="background: rgba(255, 193, 7, 0.2); padding: 15px; border-radius: 8px; text-align: center;">
                            <div style="font-size: 2rem; color: #ffc107;">0</div>
                            <div>Passwords Cracked</div>
                        </div>
                        <div style="background: rgba(0, 123, 255, 0.2); padding: 15px; border-radius: 8px; text-align: center;">
                            <div style="font-size: 2rem; color: #007bff;">0</div>
                            <div>Scans Completed</div>
                        </div>
                        <div style="background: rgba(255, 0, 255, 0.2); padding: 15px; border-radius: 8px; text-align: center;">
                            <div style="font-size: 2rem; color: #ff00ff;">0</div>
                            <div>Ciphers Cracked</div>
                        </div>
                    </div>
                </div>

                <div id="detailed-results">
                    <h4 style="color: #4dabf7; margin-bottom: 15px;">Detailed Findings:</h4>
                    <p style="color: #666;">No results yet. Use the tools to start testing and results will appear here.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Matrix background animation
        const canvas = document.getElementById('matrix');
        const ctx = canvas.getContext('2d');

        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        const matrix = "ABCDEFGHIJKLMNOPQRSTUVWXYZ123456789@#$%^&*()*&^%+-/~{[]}|";
        matrix.split("");

        const font_size = 10;
        const columns = canvas.width/font_size;

        const drops = [];
        for(let x = 0; x < columns; x++)
            drops[x] = 1;

        function draw() {
            ctx.fillStyle = 'rgba(0, 0, 0, 0.04)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            ctx.fillStyle = '#00ff00';
            ctx.font = font_size + 'px arial';

            for(let i = 0; i < drops.length; i++) {
                const text = matrix[Math.floor(Math.random()*matrix.length)];
                ctx.fillText(text, i*font_size, drops[i]*font_size);

                if(drops[i]*font_size > canvas.height && Math.random() > 0.975)
                    drops[i] = 0;

                drops[i]++;
            }
        }

        setInterval(draw, 35);

        // Game state
        let gameState = {
            vulnerabilitiesFound: 0,
            passwordsCracked: 0,
            scansCompleted: 0,
            ciphersCracked: 0,
            currentUser: null,
            isLoggedIn: false,
            findings: []
        };

        // Penetration testing data
        const users = {
            'user1': { id: 1, password: 'pass123', name: 'John Doe', email: 'john@example.com', balance: '$5,000' },
            'user2': { id: 2, password: 'mypass', name: 'Jane Smith', email: 'jane@example.com', balance: '$12,500' },
            'user3': { id: 3, password: 'secret', name: 'Bob Johnson', email: 'bob@example.com', balance: '$850' },
            'admin': { id: 4, password: 'admin123', name: 'Administrator', email: 'admin@example.com', balance: 'ADMIN ACCESS' }
        };

        const profiles = {
            1: { name: 'Ali Almarri', email: 'alshei5alialmarri@fakemail.com', department: 'IT', salary: '$75,000', ssn: '123-45-6789' },
            2: { name: 'Mohammed Al Malik', email: 'MOHAMMEDALSHEIK@company.com', department: 'Finance', salary: '$85,000', ssn: '987-65-4321' },
            3: { name: 'Fahad Al marri', email: 'FAHADALSHEIK@company.com', department: 'HR', salary: '$70,000', ssn: '456-78-9123' },
            4: { name: 'Saif Nasser Almansori', email: 'SaifALSHEIK@company.com', department: 'Marketing', salary: '$65,000', ssn: '789-12-3456' },
            5: { name: 'Khalid Al hababi', email: 'khalid@company.com', department: 'Legal', salary: '$95,000', ssn: '321-54-9876' }
        };

        const adminAccounts = {
            'admin': 'admin',
            'administrator': '123456',
            'root': 'password',
            'superuser': 'root'
        };

        const commonPasswords = [
            'password', '123456', 'admin', 'root', 'qwerty', 'letmein',
            'welcome', 'monkey', 'dragon', 'master', 'shadow', 'login',
            'pass123', 'admin123', 'password123', '12345678', 'abc123'
        ];

        // Cryptography variables
        let currentEncrypted = '';
        let currentDecrypted = '';
        let bruteForceActive = false;

        // Penetration testing variables
        let idorScanActive = false;
        let passwordCrackActive = false;

        // Tab switching
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // Penetration Testing Functions
        document.getElementById('bank-login').addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('bank-username').value;
            const password = document.getElementById('bank-password').value;
            
            if (users[username] && users[username].password === password) {
                gameState.currentUser = users[username];
                gameState.isLoggedIn = true;
                
                alert(`✅ Login Successful!\nWelcome ${users[username].name}\nBalance: ${users[username].balance}`);
                
                addFinding('success', 'Valid Credentials Found', `Username: ${username}, Password: ${password}`);
            } else {
                alert('❌ Invalid credentials');
            }
        });

        document.getElementById('admin-login').addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('admin-username').value;
            const password = document.getElementById('admin-password').value;
            
            if (adminAccounts[username] && adminAccounts[username] === password) {
                alert(`🚨 ADMIN ACCESS GRANTED!\nWelcome Administrator\nFull system access obtained!`);
                addFinding('danger', 'Admin Access Compromised', `Admin credentials: ${username}:${password}`);
                gameState.passwordsCracked++;
                updateResultsStats();
            } else {
                alert('❌ Access Denied');
            }
        });

        function showProfile() {
            document.getElementById('profile-login').style.display = 'none';
            document.getElementById('profile-section').style.display = 'block';
            loadProfile(1);
        }

        function loadProfile(id = null) {
            if (!id) {
                id = document.getElementById('profile-url').value || 1;
            }
            
            const profile = profiles[id];
            const profileContent = document.getElementById('profile-content');
            
            if (profile) {
                profileContent.innerHTML = `
                    <div style="background: rgba(0,100,0,0.1); padding: 15px; border-radius: 5px; margin: 10px 0;">
                        <h4>🎯 IDOR Vulnerability Exploited!</h4>
                        <p><strong>Profile ID:</strong> ${id}</p>
                        <p><strong>Name:</strong> ${profile.name}</p>
                        <p><strong>Email:</strong> ${profile.email}</p>
                        <p><strong>Department:</strong> ${profile.department}</p>
                        <p><strong>Salary:</strong> ${profile.salary}</p>
                        <p><strong>SSN:</strong> ${profile.ssn}</p>
                    </div>
                `;
                
                addFinding('danger', 'IDOR Vulnerability Exploited', `Accessed Profile ID: ${id} - ${profile.name}`);
                gameState.vulnerabilitiesFound++;
                updateResultsStats();
            } else {
                profileContent.innerHTML = `
                    <div style="background: rgba(100,0,0,0.1); padding: 15px; border-radius: 5px;">
                        <p>❌ Profile not found for ID: ${id}</p>
                    </div>
                `;
            }
        }

        function startIdorScan() {
            if (idorScanActive) return;
            
            idorScanActive = true;
            const terminal = document.getElementById('idor-terminal');
            const progress = document.getElementById('idor-progress');
            const results = document.getElementById('idor-results');
            
            const startId = parseInt(document.getElementById('idor-start').value) || 1;
            const endId = parseInt(document.getElementById('idor-end').value) || 20;
            const totalScans = endId - startId + 1;
            
            results.innerHTML = '<h4>🔍 IDOR Scan Results:</h4>';
            
            addTerminalLine('idor-terminal', 'prompt', `Starting IDOR scan for IDs ${startId} to ${endId}...`);
            addTerminalLine('idor-terminal', 'output', 'Scanning for insecure direct object references...');
            
            let currentId = startId;
            let vulnerableIds = [];
            
            const scanInterval = setInterval(() => {
                if (!idorScanActive || currentId > endId) {
                    clearInterval(scanInterval);
                    
                    addTerminalLine('idor-terminal', 'success', `✅ Scan completed! Found ${vulnerableIds.length} vulnerable endpoints`);
                    
                    if (vulnerableIds.length > 0) {
                        results.innerHTML += `
                            <div class="result-danger">
                                <strong>🚨 Vulnerable IDs Found:</strong> ${vulnerableIds.join(', ')}<br>
                                <strong>Impact:</strong> Unauthorized access to user profiles<br>
                                <strong>Recommendation:</strong> Implement proper authorization checks
                            </div>
                        `;
                        gameState.vulnerabilitiesFound += vulnerableIds.length;
                        addFinding('danger', 'IDOR Vulnerabilities Found', `Vulnerable IDs: ${vulnerableIds.join(', ')}`);
                    } else {
                        results.innerHTML += `
                            <div class="result-success">
                                <strong>✅ No IDOR vulnerabilities found</strong><br>
                                All endpoints properly secured
                            </div>
                        `;
                    }
                    
                    gameState.scansCompleted++;
                    updateResultsStats();
                    progress.style.width = '100%';
                    idorScanActive = false;
                    return;
                }
                
                const progressPercent = ((currentId - startId) / totalScans) * 100;
                progress.style.width = progressPercent + '%';
                
                if (profiles[currentId]) {
                    addTerminalLine('idor-terminal', 'success', `✅ ID ${currentId}: VULNERABLE - Profile accessible`);
                    vulnerableIds.push(currentId);
                } else {
                    addTerminalLine('idor-terminal', 'output', `❌ ID ${currentId}: Not found`);
                }
                
                currentId++;
            }, 500);
        }

        function stopIdorScan() {
            idorScanActive = false;
            addTerminalLine('idor-terminal', 'error', '⏹️ Scan stopped by user');
        }

        function startPasswordCrack() {
            if (passwordCrackActive) return;
            
            passwordCrackActive = true;
            const target = document.getElementById('crack-target').value;
            const method = document.getElementById('crack-method').value;
            const terminal = document.getElementById('crack-terminal');
            const progress = document.getElementById('crack-progress');
            const results = document.getElementById('crack-results');
            
            results.innerHTML = '<h4>🔐 Password Cracking Results:</h4>';
            
            addTerminalLine('crack-terminal', 'prompt', `Starting ${method} attack on ${target} target...`);
            addTerminalLine('crack-terminal', 'output', 'Loading password dictionary...');
            
            let targetCredentials = {};
            if (target === 'admin') {
                targetCredentials = adminAccounts;
            } else if (target === 'bank') {
                targetCredentials = { 'user1': users['user1'].password };
            } else {
                const customUser = document.getElementById('custom-username').value;
                if (customUser && users[customUser]) {
                    targetCredentials = { [customUser]: users[customUser].password };
                } else {
                    addTerminalLine('crack-terminal', 'error', '❌ Invalid custom target');
                    passwordCrackActive = false;
                    return;
                }
            }
            
            let passwordList = [];
            if (method === 'dictionary' || method === 'common') {
                passwordList = commonPasswords;
            } else if (method === 'brute-force') {
                passwordList = generateBruteForceList();
            }
            
            let currentIndex = 0;
            let crackedPasswords = [];
            
            const crackInterval = setInterval(() => {
                if (!passwordCrackActive || currentIndex >= passwordList.length) {
                    clearInterval(crackInterval);
                    
                    if (crackedPasswords.length > 0) {
                        addTerminalLine('crack-terminal', 'success', `🎯 SUCCESS! Cracked ${crackedPasswords.length} passwords`);
                        
                        results.innerHTML += `
                            <div class="result-danger">
                                <strong>🚨 Passwords Cracked:</strong><br>
                                ${crackedPasswords.map(cred => `${cred.username}:${cred.password}`).join('<br>')}
                            </div>
                        `;
                        
                        gameState.passwordsCracked += crackedPasswords.length;
                        crackedPasswords.forEach(cred => {
                            addFinding('danger', 'Password Cracked', `${cred.username}:${cred.password}`);
                        });
                    } else {
                        addTerminalLine('crack-terminal', 'output', '❌ No passwords cracked');
                        results.innerHTML += `
                            <div class="result-success">
                                <strong>✅ Passwords are secure</strong><br>
                                Unable to crack with current method
                            </div>
                        `;
                    }
                    
                    updateResultsStats();
                    progress.style.width = '100%';
                    passwordCrackActive = false;
                    return;
                }
                
                const currentPassword = passwordList[currentIndex];
                const progressPercent = (currentIndex / passwordList.length) * 100;
                progress.style.width = progressPercent + '%';
                
                for (const [username, correctPassword] of Object.entries(targetCredentials)) {
                    if (currentPassword === correctPassword) {
                        addTerminalLine('crack-terminal', 'success', `🎯 MATCH! ${username}:${currentPassword}`);
                        crackedPasswords.push({ username, password: currentPassword });
                    } else {
                        addTerminalLine('crack-terminal', 'output', `Trying: ${username}:${currentPassword}`);
                    }
                }
                
                currentIndex++;
            }, 200);
        }

        function stopPasswordCrack() {
            passwordCrackActive = false;
            addTerminalLine('crack-terminal', 'error', '⏹️ Attack stopped by user');
        }

        function generateBruteForceList() {
            const chars = 'abcdefghijklmnopqrstuvwxyz0123456789';
            const passwords = [];
            
            for (let len = 1; len <= 4; len++) {
                generateRecursive('', len, chars, passwords);
                if (passwords.length > 100) break;
            }
            
            return passwords.slice(0, 50);
        }

        function generateRecursive(current, maxLength, chars, passwords) {
            if (current.length === maxLength) {
                passwords.push(current);
                return;
            }
            
            for (let i = 0; i < chars.length && passwords.length < 100; i++) {
                generateRecursive(current + chars[i], maxLength, chars, passwords);
            }
        }

        // Caesar Cipher Functions
        function caesarCipher(text, shift, decrypt = false) {
            if (decrypt) shift = -shift;
            
            return text.replace(/[A-Z]/g, function(char) {
                const code = char.charCodeAt(0);
                let shifted = ((code - 65 + shift) % 26);
                if (shifted < 0) shifted += 26;
                return String.fromCharCode(shifted + 65);
            }).replace(/[a-z]/g, function(char) {
                const code = char.charCodeAt(0);
                let shifted = ((code - 97 + shift) % 26);
                if (shifted < 0) shifted += 26;
                return String.fromCharCode(shifted + 97);
            });
        }

        function updateEncryptShift() {
            const shift = parseInt(document.getElementById('encrypt-shift').value);
            document.getElementById('encrypt-shift-value').textContent = shift;
            
            const originalChar = String.fromCharCode(65);
            const shiftedChar = String.fromCharCode(((65 - 65 + shift) % 26) + 65);
            document.getElementById('encrypt-shift-display').textContent = 
                `Shift: ${shift} (A → ${shiftedChar}, B → ${String.fromCharCode(((66 - 65 + shift) % 26) + 65)}, C → ${String.fromCharCode(((67 - 65 + shift) % 26) + 65)}...)`;
            
            updateAlphabetTable(shift);
        }

        function updateAlphabetTable(shift) {
            const original = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            let shifted = '';
            
            for (let i = 0; i < 26; i++) {
                const shiftedIndex = (i + shift) % 26;
                shifted += String.fromCharCode(shiftedIndex + 65);
            }
            
            document.getElementById('original-alphabet').textContent = original;
            document.getElementById('shifted-alphabet').textContent = shifted;
        }

        function encryptText() {
            const text = document.getElementById('encrypt-input').value.trim();
            const shift = parseInt(document.getElementById('encrypt-shift').value);
            
            if (!text) {
                addTerminalLine('encrypt-terminal', 'error', '❌ Please enter text to encrypt');
                return;
            }
            
            const encrypted = caesarCipher(text, shift);
            currentEncrypted = encrypted;
            
            const output = document.getElementById('encrypt-output');
            output.textContent = encrypted;
            output.classList.remove('empty');
            output.querySelector('.copy-btn').style.display = 'block';
            
            addTerminalLine('encrypt-terminal', 'success', `✅ Text encrypted with shift ${shift}`);
            addTerminalLine('encrypt-terminal', 'output', `Length: ${text.length} → ${encrypted.length} characters`);
            addTerminalLine('encrypt-terminal', 'output', `Key used: ${shift}`);
            
            addFinding('success', 'Text Encrypted', `Caesar cipher with shift ${shift}`);
        }

        function clearEncrypt() {
            document.getElementById('encrypt-input').value = '';
            const output = document.getElementById('encrypt-output');
            output.textContent = 'Enter text and click "Encrypt Text" to see the result here';
            output.classList.add('empty');
            output.querySelector('.copy-btn').style.display = 'none';
            currentEncrypted = '';
            addTerminalLine('encrypt-terminal', 'output', '🗑️ Text and results cleared');
        }

        function copyEncrypted() {
            if (currentEncrypted) {
                navigator.clipboard.writeText(currentEncrypted).then(() => {
                    const btn = document.querySelector('#encrypt-output .copy-btn');
                    const originalText = btn.textContent;
                    btn.textContent = '✅ Copied';
                    setTimeout(() => {
                        btn.textContent = originalText;
                    }, 2000);
                    addTerminalLine('encrypt-terminal', 'success', '📋 Encrypted text copied');
                });
            }
        }

        function updateDecryptShift() {
            const shift = parseInt(document.getElementById('decrypt-shift').value);
            document.getElementById('decrypt-shift-value').textContent = shift;
            
            const shiftedChar = String.fromCharCode(((68 - 65 - shift + 26) % 26) + 65);
            document.getElementById('decrypt-shift-display').textContent = 
                `Shift: ${shift} (D → ${shiftedChar}, E → ${String.fromCharCode(((69 - 65 - shift + 26) % 26) + 65)}, F → ${String.fromCharCode(((70 - 65 - shift + 26) % 26) + 65)}...)`;
        }

        function decryptText() {
            const text = document.getElementById('decrypt-input').value.trim();
            const shift = parseInt(document.getElementById('decrypt-shift').value);
            
            if (!text) {
                addTerminalLine('decrypt-terminal', 'error', '❌ Please enter encrypted text to decrypt');
                return;
            }
            
            const decrypted = caesarCipher(text, shift, true);
            currentDecrypted = decrypted;
            
            const output = document.getElementById('decrypt-output');
            output.textContent = decrypted;
            output.classList.remove('empty');
            output.querySelector('.copy-btn').style.display = 'block';
            
            addTerminalLine('decrypt-terminal', 'success', `✅ Text decrypted with shift ${shift}`);
            addTerminalLine('decrypt-terminal', 'output', `Length: ${text.length} → ${decrypted.length} characters`);
            addTerminalLine('decrypt-terminal', 'output', `Key used: ${shift}`);
            
            addFinding('success', 'Text Decrypted', `Caesar cipher with shift ${shift}`);
        }

        function clearDecrypt() {
            document.getElementById('decrypt-input').value = '';
            const output = document.getElementById('decrypt-output');
            output.textContent = 'Enter encrypted text and click "Decrypt Text" to see the result here';
            output.classList.add('empty');
            output.querySelector('.copy-btn').style.display = 'none';
            currentDecrypted = '';
            addTerminalLine('decrypt-terminal', 'output', '🗑️ Text and results cleared');
        }

        function copyDecrypted() {
            if (currentDecrypted) {
                navigator.clipboard.writeText(currentDecrypted).then(() => {
                    const btn = document.querySelector('#decrypt-output .copy-btn');
                    const originalText = btn.textContent;
                    btn.textContent = '✅ Copied';
                    setTimeout(() => {
                        btn.textContent = originalText;
                    }, 2000);
                    addTerminalLine('decrypt-terminal', 'success', '📋 Decrypted text copied');
                });
            }
        }

        function analyzeFrequency() {
            const text = document.getElementById('analyze-input').value.trim().toUpperCase();
            
            if (!text) {
                addTerminalLine('analyzer-terminal', 'error', '❌ Please enter text to analyze');
                return;
            }
            
            const frequency = {};
            let totalChars = 0;
            
            for (let char of text) {
                if (char.match(/[A-Z]/)) {
                    frequency[char] = (frequency[char] || 0) + 1;
                    totalChars++;
                }
            }
            
            const uniqueChars = Object.keys(frequency).length;
            const sortedFreq = Object.entries(frequency).sort((a, b) => b[1] - a[1]);
            const mostCommon = sortedFreq[0] ? sortedFreq[0][0] : '-';
            
            document.getElementById('total-chars').textContent = totalChars;
            document.getElementById('unique-chars').textContent = uniqueChars;
            document.getElementById('most-common').textContent = mostCommon;
            
            createFrequencyChart(frequency, totalChars);
            
            addTerminalLine('analyzer-terminal', 'success', `✅ Text analyzed: ${totalChars} characters`);
            addTerminalLine('analyzer-terminal', 'output', `Unique characters: ${uniqueChars}`);
            addTerminalLine('analyzer-terminal', 'output', `Most frequent: ${mostCommon} (${sortedFreq[0] ? sortedFreq[0][1] : 0} times)`);
            
            if (mostCommon !== '-') {
                const suggestedShift = (mostCommon.charCodeAt(0) - 69 + 26) % 26;
                if (suggestedShift > 0) {
                    addTerminalLine('analyzer-terminal', 'output', `💡 Suggested shift: ${suggestedShift} (if ${mostCommon} = E)`);
                }
            }
            
            addFinding('success', 'Frequency Analysis Completed', `Analyzed ${totalChars} characters`);
        }

        function createFrequencyChart(frequency, totalChars) {
            const chart = document.getElementById('frequency-chart');
            chart.innerHTML = '';
            
            const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            
            for (let char of alphabet) {
                const count = frequency[char] || 0;
                const percentage = totalChars > 0 ? (count / totalChars) * 100 : 0;
                
                const bar = document.createElement('div');
                bar.className = 'freq-bar';
                
                const fill = document.createElement('div');
                fill.className = 'freq-fill';
                fill.style.height = Math.max(percentage * 2, 2) + 'px';
                
                const label = document.createElement('div');
                label.className = 'freq-label';
                label.textContent = char;
                
                bar.appendChild(fill);
                bar.appendChild(label);
                chart.appendChild(bar);
                
                bar.title = `${char}: ${count} (${percentage.toFixed(1)}%)`;
            }
        }

        function clearAnalyzer() {
            document.getElementById('analyze-input').value = '';
            document.getElementById('total-chars').textContent = '0';
            document.getElementById('unique-chars').textContent = '0';
            document.getElementById('most-common').textContent = '-';
            
            const chart = document.getElementById('frequency-chart');
            chart.innerHTML = '<p style="color: #666; text-align: center;">Enter text to analyze</p>';
            
            addTerminalLine('analyzer-terminal', 'output', '🗑️ Analysis cleared');
        }

        function startBruteForce() {
            const text = document.getElementById('brute-input').value.trim();
            
            if (!text) {
                addTerminalLine('brute-terminal', 'error', '❌ Please enter encrypted text to crack');
                return;
            }
            
            if (bruteForceActive) {
                addTerminalLine('brute-terminal', 'error', '⚠️ Brute force already running');
                return;
            }
            
            bruteForceActive = true;
            const results = document.getElementById('brute-results');
            results.innerHTML = '<h4 style="color: #4dabf7; margin-bottom: 15px;">🎯 Brute Force Results:</h4>';
            
            addTerminalLine('brute-terminal', 'prompt', 'Starting Caesar cipher brute force attack...');
            addTerminalLine('brute-terminal', 'output', 'Trying all shifts from 1 to 25...');
            
            let shift = 1;
            
            const bruteInterval = setInterval(() => {
                if (!bruteForceActive || shift > 25) {
                    clearInterval(bruteInterval);
                    addTerminalLine('brute-terminal', 'success', '✅ All attempts completed');
                    addFinding('success', 'Caesar Brute Force Completed', `All 25 shifts attempted`);
                    gameState.ciphersCracked++;
                    updateResultsStats();
                    bruteForceActive = false;
                    return;
                }
                
                const decrypted = caesarCipher(text, shift, true);
                
                const resultDiv = document.createElement('div');
                resultDiv.style.cssText = 'background: rgba(40, 40, 40, 0.8); border: 1px solid #555; border-radius: 5px; padding: 15px; margin: 10px 0; border-left: 4px solid #00ff00;';
                
                resultDiv.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <strong style="color: #00ff00;">Shift ${shift}:</strong>
                        <button onclick="copyResult('${decrypted.replace(/'/g, "\\'")}', ${shift})" style="background: rgba(0, 255, 0, 0.2); border: 1px solid #00ff00; color: #00ff00; padding: 5px 10px; border-radius: 3px; cursor: pointer; font-size: 0.8rem;">📋 Copy</button>
                    </div>
                    <div style="font-family: 'Courier New', monospace; background: #000; padding: 10px; border-radius: 3px; word-break: break-all;">${decrypted}</div>
                `;
                
                results.appendChild(resultDiv);
                results.scrollTop = results.scrollHeight;
                
                addTerminalLine('brute-terminal', 'output', `Shift ${shift}: ${decrypted.substring(0, 30)}${decrypted.length > 30 ? '...' : ''}`);
                
                shift++;
            }, 500);
        }

        function stopBruteForce() {
            bruteForceActive = false;
            addTerminalLine('brute-terminal', 'error', '⏹️ Brute force stopped');
        }

        function clearBruteForce() {
            document.getElementById('brute-input').value = '';
            document.getElementById('brute-results').innerHTML = '<p style="color: #666; text-align: center; padding: 20px;">Enter encrypted text and click "Start Cracking" to see all possibilities</p>';
            bruteForceActive = false;
            addTerminalLine('brute-terminal', 'output', '🗑️ Text and results cleared');
        }

        function copyResult(text, shift) {
            navigator.clipboard.writeText(text).then(() => {
                addTerminalLine('brute-terminal', 'success', `📋 Copied result from shift ${shift}`);
            });
        }

        // Helper functions
        function addTerminalLine(terminalId, type, text) {
            const terminal = document.getElementById(terminalId);
            const line = document.createElement('div');
            line.className = `terminal-line terminal-${type}`;
            line.textContent = type === 'prompt' ? `root@cyberlab:~# ${text}` : text;
            terminal.appendChild(line);
            terminal.scrollTop = terminal.scrollHeight;
            
            const lines = terminal.querySelectorAll('.terminal-line');
            if (lines.length > 15) {
                lines[0].remove();
            }
        }

        function addFinding(severity, title, description) {
            gameState.findings.push({
                timestamp: new Date().toLocaleTimeString(),
                severity: severity,
                title: title,
                description: description
            });
            updateDetailedResults();
        }

        function updateResultsStats() {
            const statsDiv = document.getElementById('results-summary');
            statsDiv.innerHTML = `
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px;">
                    <div style="background: rgba(220, 53, 69, 0.2); padding: 15px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 2rem; color: #dc3545;">${gameState.vulnerabilitiesFound}</div>
                        <div>Vulnerabilities Found</div>
                    </div>
                    <div style="background: rgba(255, 193, 7, 0.2); padding: 15px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 2rem; color: #ffc107;">${gameState.passwordsCracked}</div>
                        <div>Passwords Cracked</div>
                    </div>
                    <div style="background: rgba(0, 123, 255, 0.2); padding: 15px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 2rem; color: #007bff;">${gameState.scansCompleted}</div>
                        <div>Scans Completed</div>
                    </div>
                    <div style="background: rgba(255, 0, 255, 0.2); padding: 15px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 2rem; color: #ff00ff;">${gameState.ciphersCracked}</div>
                        <div>Ciphers Cracked</div>
                    </div>
                </div>
            `;
        }

        function updateDetailedResults() {
            const detailedDiv = document.getElementById('detailed-results');
            
            if (gameState.findings.length === 0) {
                detailedDiv.innerHTML = `
                    <h4 style="color: #4dabf7; margin-bottom: 15px;">Detailed Findings:</h4>
                    <p style="color: #666;">No results yet. Use the tools to start testing and results will appear here.</p>
                `;
                return;
            }
            
            let html = '<h4 style="color: #4dabf7; margin-bottom: 15px;">Detailed Findings:</h4>';
            
            gameState.findings.forEach((finding, index) => {
                html += `
                    <div class="result-item result-${finding.severity}">
                        <strong>[${finding.timestamp}] ${finding.title}</strong><br>
                        ${finding.description}
                    </div>
                `;
            });
            
            detailedDiv.innerHTML = html;
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateResultsStats();
            updateEncryptShift();
            updateDecryptShift();
            
            setTimeout(() => {
                addTerminalLine('idor-terminal', 'output', 'System ready. Click "Start IDOR Scan" to begin testing...');
                addTerminalLine('crack-terminal', 'output', 'Password cracking tools loaded. Select target and method to start...');
                addTerminalLine('encrypt-terminal', 'output', 'System ready for text encryption...');
                addTerminalLine('decrypt-terminal', 'output', 'System ready for text decryption...');
                addTerminalLine('analyzer-terminal', 'output', 'System ready for character frequency analysis...');
                addTerminalLine('brute-terminal', 'output', 'System ready for Caesar cipher brute force cracking...');
            }, 2000);
        });

        // Resize canvas on window resize
        window.addEventListener('resize', function() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });
    </script>
</body>
</html>